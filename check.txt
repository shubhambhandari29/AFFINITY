Short answer: treat F5 APM as your IdP/gateway, and have your FastAPI app trust user identity + group claims passed in a signed token (preferred) or trusted headers. Then map the incoming AD group to your roles (underwriter/admin/director).

End‑to‑end roadmap

Decide auth protocol: OIDC (preferred) or SAML via F5 APM. OIDC gives JWTs; SAML gives assertions that F5 can translate to headers.
F5 APM setup:
Connect F5 APM to Azure AD (OIDC/SAML federation).
Define which attributes/claims to pass (user ID, groups).
If groups are large, filter to only the 3 app groups or use Azure AD app roles.
App integration:
If OIDC: validate JWT in FastAPI (issuer, audience, signature, exp). Read sub or oid as user ID, and groups/roles for role mapping.
If SAML via headers: have F5 inject trusted headers (e.g., x-user-id, x-groups) and ensure FastAPI only accepts those headers from the F5 proxy.
Authorization mapping:
Map AD group → app role (underwriter/admin/director).
Implement role checks in your routes/services.
User provisioning:
On first login, create/update local user profile with ID + role(s).
Optionally sync group changes on each request or via background sync.
Observability & audit:
Log user ID, groups, and decision outcomes.
Add metrics for auth failures and group mismatches.
Security hardening:
Enforce HTTPS to F5 and from F5 to app.
Lock down network so only F5 can reach the app.
Validate token signatures or verify headers with a shared secret/HMAC.
Testing & rollout:
Dev/stage environment with F5 APM and Azure AD test tenant.
End-to-end tests for each role.
Gradual rollout with fallback to existing auth if needed.
Connections you need

F5 APM ↔ Azure AD (OIDC/SAML federation).
F5 APM ↔ FastAPI app (reverse proxy).
Optional: FastAPI ↔ Azure AD Graph/Microsoft Graph if you need live group queries (usually not required if claims are passed).
Challenges to expect

Group overage: Azure AD may omit groups if too many; fix by filtering groups or using app roles.
Header spoofing: if using headers, you must ensure only F5 can call the app.
Token validation: proper JWKS fetching, key rotation, clock skew.
Role drift: user group changes not reflected until re-login unless you refresh tokens.
Multi‑app consistency: ensure the same claims/roles across environments.
How F5 APM and FastAPI connect

F5 sits in front as a reverse proxy.
It authenticates users against Azure AD.
It passes identity to FastAPI as JWT (OIDC) or trusted headers (SAML → headers).
FastAPI validates and authorizes.
If you want, I can tailor this to your codebase and sketch the exact middleware + config changes.
Quick questions to align:

Are you already using any auth in FastAPI?
Will F5 APM be configured for OIDC or SAML?
Do you want JWT validation in-app, or to trust F5 headers only?
How will group names be provided (actual AD group names vs. app roles)?